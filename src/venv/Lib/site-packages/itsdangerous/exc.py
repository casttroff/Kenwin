<<<<<<< HEAD
import typing as _t
from datetime import datetime

_t_opt_any = _t.Optional[_t.Any]
_t_opt_exc = _t.Optional[Exception]
=======
from ._compat import PY2
from ._compat import text_type
>>>>>>> 8ea21d60320e8cc8ae7d381c28e4c334b8d95b8b


class BadData(Exception):
    """Raised if bad data of any sort was encountered. This is the base
<<<<<<< HEAD
    for all exceptions that ItsDangerous defines.
=======
    for all exceptions that itsdangerous defines.
>>>>>>> 8ea21d60320e8cc8ae7d381c28e4c334b8d95b8b

    .. versionadded:: 0.15
    """

<<<<<<< HEAD
    def __init__(self, message: str):
        super().__init__(message)
        self.message = message

    def __str__(self) -> str:
        return self.message
=======
    message = None

    def __init__(self, message):
        super(BadData, self).__init__(self, message)
        self.message = message

    def __str__(self):
        return text_type(self.message)

    if PY2:
        __unicode__ = __str__

        def __str__(self):
            return self.__unicode__().encode("utf-8")
>>>>>>> 8ea21d60320e8cc8ae7d381c28e4c334b8d95b8b


class BadSignature(BadData):
    """Raised if a signature does not match."""

<<<<<<< HEAD
    def __init__(self, message: str, payload: _t_opt_any = None):
        super().__init__(message)
=======
    def __init__(self, message, payload=None):
        BadData.__init__(self, message)
>>>>>>> 8ea21d60320e8cc8ae7d381c28e4c334b8d95b8b

        #: The payload that failed the signature test. In some
        #: situations you might still want to inspect this, even if
        #: you know it was tampered with.
        #:
        #: .. versionadded:: 0.14
<<<<<<< HEAD
        self.payload: _t_opt_any = payload
=======
        self.payload = payload
>>>>>>> 8ea21d60320e8cc8ae7d381c28e4c334b8d95b8b


class BadTimeSignature(BadSignature):
    """Raised if a time-based signature is invalid. This is a subclass
    of :class:`BadSignature`.
    """

<<<<<<< HEAD
    def __init__(
        self,
        message: str,
        payload: _t_opt_any = None,
        date_signed: _t.Optional[datetime] = None,
    ):
        super().__init__(message, payload)
=======
    def __init__(self, message, payload=None, date_signed=None):
        BadSignature.__init__(self, message, payload)
>>>>>>> 8ea21d60320e8cc8ae7d381c28e4c334b8d95b8b

        #: If the signature expired this exposes the date of when the
        #: signature was created. This can be helpful in order to
        #: tell the user how long a link has been gone stale.
        #:
<<<<<<< HEAD
        #: .. versionchanged:: 2.0
        #:     The datetime value is timezone-aware rather than naive.
        #:
=======
>>>>>>> 8ea21d60320e8cc8ae7d381c28e4c334b8d95b8b
        #: .. versionadded:: 0.14
        self.date_signed = date_signed


class SignatureExpired(BadTimeSignature):
    """Raised if a signature timestamp is older than ``max_age``. This
    is a subclass of :exc:`BadTimeSignature`.
    """


class BadHeader(BadSignature):
    """Raised if a signed header is invalid in some form. This only
    happens for serializers that have a header that goes with the
    signature.

    .. versionadded:: 0.24
    """

<<<<<<< HEAD
    def __init__(
        self,
        message: str,
        payload: _t_opt_any = None,
        header: _t_opt_any = None,
        original_error: _t_opt_exc = None,
    ):
        super().__init__(message, payload)

        #: If the header is actually available but just malformed it
        #: might be stored here.
        self.header: _t_opt_any = header

        #: If available, the error that indicates why the payload was
        #: not valid. This might be ``None``.
        self.original_error: _t_opt_exc = original_error
=======
    def __init__(self, message, payload=None, header=None, original_error=None):
        BadSignature.__init__(self, message, payload)

        #: If the header is actually available but just malformed it
        #: might be stored here.
        self.header = header

        #: If available, the error that indicates why the payload was
        #: not valid. This might be ``None``.
        self.original_error = original_error
>>>>>>> 8ea21d60320e8cc8ae7d381c28e4c334b8d95b8b


class BadPayload(BadData):
    """Raised if a payload is invalid. This could happen if the payload
    is loaded despite an invalid signature, or if there is a mismatch
    between the serializer and deserializer. The original exception
    that occurred during loading is stored on as :attr:`original_error`.

    .. versionadded:: 0.15
    """

<<<<<<< HEAD
    def __init__(self, message: str, original_error: _t_opt_exc = None):
        super().__init__(message)

        #: If available, the error that indicates why the payload was
        #: not valid. This might be ``None``.
        self.original_error: _t_opt_exc = original_error
=======
    def __init__(self, message, original_error=None):
        BadData.__init__(self, message)

        #: If available, the error that indicates why the payload was
        #: not valid. This might be ``None``.
        self.original_error = original_error
>>>>>>> 8ea21d60320e8cc8ae7d381c28e4c334b8d95b8b
